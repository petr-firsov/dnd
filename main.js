(()=>{"use strict";const e=Array.from(document.querySelectorAll(".card-box"));function t(){const e=Array.from(document.getElementsByClassName("card"));e.forEach((t=>t.addEventListener("mousedown",(t=>{t.preventDefault();let n=t.target;n.classList.add("dragged");let d=n.getBoundingClientRect(),l=t.clientY-d.y,o=t.clientX-d.x;document.documentElement.addEventListener("mouseover",(e=>{n.style.top=e.clientY-l+"px",n.style.left=e.clientX-o+"px"})),document.documentElement.addEventListener("mouseover",(e=>{if(e.target.classList.contains("card")&&!e.target.classList.contains("dragged")){let t=Array.from(e.target.parentElement.children);if(t.every((e=>!e.classList.contains("space")))){console.log(t);let d=e.target.getBoundingClientRect().top,l=e.target.getBoundingClientRect().bottom,o=d+e.target.getBoundingClientRect().height/2;if(d<=e.clientY<=o){let t=document.createElement("div");t.style.width=n.getBoundingClientRect().width+"px",t.style.height=n.getBoundingClientRect().height+"px",t.style.backgroundColor="lightgrey",t.classList.add("space"),e.target.insertAdjacentElement("beforebegin",t)}else if(o<e.clientY<=l){let t=document.createElement("div");t.style.width=n.getBoundingClientRect().width+"px",t.style.height=n.getBoundingClientRect().height+"px",t.style.backgroundColor="transparent",e.target.insertAdjacentElement("afterend",t)}}}})),e.forEach((e=>e.addEventListener("mouseout",(()=>{let t=e.parentElement.children;for(let e=0;e<t.length;e++)t[e].classList.contains("space")&&t[e].remove()})))),document.documentElement.addEventListener("mouseup",(()=>{n.classList.remove("dragged")}))}))))}function n(){const e=document.querySelectorAll(".remove-button");for(let t=0;t<e.length;t++)e[t].addEventListener("click",(()=>{e[t].parentElement.remove()}))}!function(){const d=document.querySelectorAll(".add-link");for(let l=0;l<d.length;l++)d[l].addEventListener("click",(o=>{o.target.setAttribute("hidden","");const a=document.createElement("form");a.classList.add("add-card-form"),e[l].appendChild(a);const r=document.createElement("textarea");r.setAttribute("placeholder","Enter a title for this card..."),a.appendChild(r),r.focus();const c=document.createElement("button");c.classList.add("add-button"),c.textContent="Add button",a.appendChild(c);const i=document.createElement("div");i.classList.add("cancel-button"),i.innerHTML="&#x2715;",a.appendChild(i),a.addEventListener("submit",(o=>{if(o.preventDefault(),r.value){const d=document.createElement("div");d.classList.add("card");const o=document.createElement("p");o.classList.add("card-text"),o.innerText=r.value,d.appendChild(o);const a=document.createElement("div");a.classList.add("remove-button"),a.innerHTML="<div>&#x2715;</div>",d.append(a),e[l].appendChild(d),t(),n()}a.remove(),d[l].removeAttribute("hidden","")})),i.addEventListener("click",(()=>{a.remove(),d[l].removeAttribute("hidden","")}))}))}(),window.addEventListener("beforeunload",(()=>{let t={};for(let n=0;n<e.length;n++){let d=[];Array.from(e[n].children).forEach((e=>{let t=e.firstChild;d.push(t.textContent)})),t[n]=d}localStorage.setItem("formData",JSON.stringify(t))})),document.addEventListener("DOMContentLoaded",(()=>{const d=localStorage.getItem("formData");let l=JSON.parse(d);if(l){let d=[];for(let e in l)d.push(l[e]);for(let t=0;t<d.length;t++)for(let n=0;n<d[t].length;n++){let l=document.createElement("div");l.classList.add("card"),l.textContent=d[t][n];const o=document.createElement("div");o.classList.add("remove-button"),o.innerHTML="<div>&#x2715;</div>",l.append(o),e[t].appendChild(l)}t(),n()}}))})();